<!doctype html>
<html lang="ua">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="styles.css">
    <title>Web Logica</title>
</head>
<body>

<center>

<section id="reshenie">

    <div id="dviykova">
        <label class="r">2</label><input class="r" type="text"><button class="r">СКОПІЮВАТИ</button>
    </div>
    
    <br>
    
    <div id="visimkova">
        <label class="r">8</label><input class="r" type="text"><button class="r">СКОПІЮВАТИ</button>
    </div>
    
    <br>
    
    <div id="desyatkova">
        <label class="r">10</label><input class="r" type="text"><button class="r">СКОПІЮВАТИ</button>
    </div>
    
    <br>
    
    <div id="shistnadcyatkova">
        <label class="r">16</label><input class="r" type="text"><button class="r">СКОПІЮВАТИ</button>
    </div>
    
    <br>
    
    <button id="reset-button">ЗКИНУТИ</button>

</section>

<br>
<hr>
<br>

<section id="history">
    <div id="hheader">
        <label class="h">HISTORY</label><button id="clear-button">ОЧИСТИТИ ІСТОРІЮ</button>
    </div>
    <div id="historyList"></div>
</section>

<br>
<br>
<br>
<hr>
<br>

<footer>
    <i id="footer-text">© 2019-2024, Біцай Кирило. Усі права захищені.</i>
</footer>

</center>

</body>
</html>

<script>
var dviykova_div = document.getElementById("dviykova")
var dviykova_input = dviykova_div.getElementsByTagName("input")[0]

var visimkova_div = document.getElementById("visimkova")
var visimkova_input = visimkova_div.getElementsByTagName("input")[0]

var desyatkova_div = document.getElementById("desyatkova")
var desyatkova_input = desyatkova_div.getElementsByTagName("input")[0]

var shistnadcyatkova_div = document.getElementById("shistnadcyatkova")
var shistnadcyatkova_input = shistnadcyatkova_div.getElementsByTagName("input")[0]

var reset_button = document.getElementById("reset-button")
var clear_button = document.getElementById("clear-button")

var historyList = document.getElementById("historyList")

function UpdateHistory(WithClear){
    newLolStorage = localStorage.getItem("convhistory")

    if (newLolStorage == undefined) { newLolStorage = [] } else { newLolStorage = JSON.parse(newLolStorage) }

    newLolStorage = newLolStorage.filter(function(item, pos, self) {
        return self.indexOf(item) == pos;
    })

    if (WithClear) { historyList.innerHTML = "" }

    for (key of newLolStorage) {
        let splitted = String(key).split(" / ")
        splitted0 = "'" + splitted[0] + "'"
        splitted1 = "'" + splitted[1] + "'"
        historyList.innerHTML = historyList.innerHTML + '<button class="h" onclick="UpdateInputs('+splitted0+', '+splitted1+', false)">' + splitted[0] + " | " + splitted[1] + "</button><br>"
    }
}

function UpdateInputs(InputType, InputValue, LogIt){
    if (LogIt === true){
        newLolStorage = localStorage.getItem("convhistory")

        if (newLolStorage == undefined) { newLolStorage = [] } else { newLolStorage = JSON.parse(newLolStorage) }        

        newLolStorage.push(String(InputType) + " / " + String(InputValue))

        localStorage.setItem("convhistory", JSON.stringify(newLolStorage))
        
        UpdateHistory(true)
    }

    if (InputType == "Двійкова"){
        let decimal = parseInt(InputValue, 2)
        dviykova_input.value = decimal.toString(2)
        visimkova_input.value = decimal.toString(8)
        desyatkova_input.value = decimal
        shistnadcyatkova_input.value = decimal.toString(16)

    } else if (InputType == "Вісімкова"){
        let decimal = parseInt(InputValue, 8)
        dviykova_input.value = decimal.toString(2)
        visimkova_input.value = decimal.toString(8)
        desyatkova_input.value = decimal
        shistnadcyatkova_input.value = decimal.toString(16)

    } else if (InputType == "Десяткова"){
        let decimal = Number(InputValue)
        dviykova_input.value = decimal.toString(2)
        visimkova_input.value = decimal.toString(8)
        desyatkova_input.value = decimal
        shistnadcyatkova_input.value = decimal.toString(16)
        
    } else if (InputType == "Шістнадцяткова"){
        let decimal = parseInt(InputValue, 16)
        dviykova_input.value = decimal.toString(2)
        visimkova_input.value = decimal.toString(8)
        desyatkova_input.value = decimal
        shistnadcyatkova_input.value = decimal.toString(16)
    }
}

dviykova_input.onchange = function(){
    UpdateInputs("Двійкова", dviykova_input.value, true)
}
visimkova_input.onchange = function(){
    UpdateInputs("Вісімкова", visimkova_input.value, true)
}
desyatkova_input.onchange = function(){
    UpdateInputs("Десяткова", desyatkova_input.value, true)
}
shistnadcyatkova_input.onchange = function(){
    UpdateInputs("Шістнадцяткова", shistnadcyatkova_input.value, true)
}

reset_button.onclick = function(){
    UpdateInputs("Двійкова", 0, false)
    UpdateInputs("Вісімкова", 0, false)
    UpdateInputs("Десяткова", 0, false)
    UpdateInputs("Шістнадцяткова", 0, false)
}

clear_button.onclick = function(){
    localStorage.removeItem("convhistory")
    UpdateHistory(true)
}

var footer_text = document.getElementById("footer-text")
footer_text.onclick = function(){
    if (!String(footer_text.innerHTML).endsWith("Мабуть.")) { 
        footer_text.innerHTML = footer_text.innerHTML + " Мабуть." 
        footer_text.style.cursor = "default"
    }
}


UpdateHistory(true)

</script>